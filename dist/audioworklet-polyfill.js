!function(){function e(e,t){var r=document.createElement("iframe");r.style.cssText="position:absolute;left:0;top:-999px;width:1px;height:1px;",t.appendChild(r);var o=r.contentWindow,n=o.document,i="var window,$hook";for(var a in o)a in e||"eval"===a||(i+=",",i+=a);for(var s in e)i+=",",i+=s,i+="=self.",i+=s;var u=n.createElement("script");u.appendChild(n.createTextNode('function $hook(self,console) {"use strict";\n        '+i+";return function() {return eval(arguments[0])}}")),n.body.appendChild(u),this.exec=o.$hook.call(e,e,console)}var t,r=[];function o(e){var t=this,o={},i=-1;this.parameters.forEach(function(e,n){var a=r[++i]||(r[i]=new Float32Array(t.bufferSize));a.fill(e.value),o[n]=a}),this.processor.realm.exec("self.sampleRate=sampleRate="+this.context.sampleRate+";self.currentTime=currentTime="+this.context.currentTime);var a=n(e.inputBuffer),s=n(e.outputBuffer);this.instance.process([a],[s],o)}function n(e){for(var t=[],r=0;r<e.numberOfChannels;r++)t[r]=e.getChannelData(r);return t}function i(e){return e.$$processors||(e.$$processors={})}"function"==typeof AudioWorkletNode&&"audioWorklet"in AudioContext.prototype||(self.AudioWorkletNode=function(e,r,n){var a=i(e)[r],s=e.createScriptProcessor(void 0,2,n&&n.outputChannelCount?n.outputChannelCount[0]:2);if(s.parameters=new Map,a.properties)for(var u=0;u<a.properties.length;u++){var c=a.properties[u],l=e.createGain().gain;l.value=c.defaultValue,s.parameters.set(c.name,l)}var p=new MessageChannel;t=p.port2;var f=new a.Processor(n||{});return t=null,s.port=p.port1,s.processor=a,s.instance=f,s.onaudioprocess=o,s},Object.defineProperty((self.AudioContext||self.webkitAudioContext).prototype,"audioWorklet",{get:function(){return this.$$audioWorklet||(this.$$audioWorklet=new self.AudioWorklet(this))}}),self.AudioWorklet=function(){function r(e){this.$$context=e}return r.prototype.addModule=function(r,o){var n=this;return fetch(r).then(function(e){if(!e.ok)throw Error(e.status);return e.text()}).then(function(r){var a={sampleRate:n.$$context.sampleRate,currentTime:n.$$context.currentTime,AudioWorkletProcessor:function(){this.port=t},registerProcessor:function(e,t){i(n.$$context)[e]={realm:s,context:a,Processor:t,properties:t.parameterDescriptors||[]}}};a.self=a;var s=new e(a,document.documentElement);return s.exec((o&&o.transpile||String)(r)),null})},r}())}();
//# sourceMappingURL=audioworklet-polyfill.js.map
